<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to mhpfilter • mhpfilter</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to mhpfilter">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mhpfilter</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/introduction.html"><span class="fa fa-file-text-o"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to mhpfilter</a></li>
    <li><a class="dropdown-item" href="../articles/methodology.html">Mathematical Methodology</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/myaseen208/mhpfilter" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cran.r-project.org/package=mhpfilter" aria-label="CRAN"><span class="fa fa-download"></span> CRAN</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.researchgate.net/profile/Muhammad_Yaseen10" aria-label="ResearchGate"><span class="fa fa-graduation-cap"></span> ResearchGate</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/myaseen208" aria-label="Twitter"><span class="fa fab fa-twitter"></span> Twitter</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to mhpfilter</h1>
                        <h4 data-toc-skip class="author">Muhammad
Yaseen</h4>
            <address class="author_afil">
      School of Mathematical and Statistical Sciences, Clemson
University<br><a class="author_email" href="mailto:#"></a><a href="mailto:myaseen208@gmail.com" class="email">myaseen208@gmail.com</a>
      </address>
                              <h4 data-toc-skip class="author">Javed
Iqbal</h4>
            <address class="author_afil">
      State Bank of
Pakistan<br><a class="author_email" href="mailto:#"></a><a href="mailto:Javed.iqbal6@sbp.org.pk" class="email">Javed.iqbal6@sbp.org.pk</a>
      </address>
                              <h4 data-toc-skip class="author">M. Nadim
Hanif</h4>
            <address class="author_afil">
      State Bank of
Pakistan<br><a class="author_email" href="mailto:#"></a><a href="mailto:Nadeem.hanif@sbp.org.pk" class="email">Nadeem.hanif@sbp.org.pk</a>
      </address>
                  
            <h4 data-toc-skip class="date">2026-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/myaseen208/mhpfilter/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>mhpfilter</code> package provides a fast, efficient
implementation of the <strong>Modified Hodrick-Prescott (HP)
filter</strong> for decomposing time series into trend and cyclical
components. The key innovation is <strong>automatic optimal
selection</strong> of the smoothing parameter λ using generalized
cross-validation (GCV), based on the methodology of Choudhary, Hanif
&amp; Iqbal (2014).</p>
<div class="section level3">
<h3 id="why-modified-hp-filter">Why Modified HP Filter?<a class="anchor" aria-label="anchor" href="#why-modified-hp-filter"></a>
</h3>
<p>The standard HP filter uses <strong>fixed λ values</strong>:</p>
<ul>
<li>λ = 1600 for quarterly data</li>
<li>λ = 100 for annual data<br>
</li>
<li>λ = 14400 for monthly data</li>
</ul>
<p>However, these values were calibrated for U.S. quarterly GDP in the
1990s. They may not be appropriate for:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Different countries</strong> (emerging markets vs developed
economies)</li>
<li>
<strong>Different variables</strong> (investment is more volatile
than consumption)</li>
<li>
<strong>Different time periods</strong> (pre/post Great
Moderation)</li>
</ol>
<p>The Modified HP filter solves this by <strong>estimating the optimal
λ</strong> from the data itself using the GCV criterion:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">GCV</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mn>2</mn><mi>T</mi></mrow><mi>λ</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>−</mo><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\text{GCV}(\lambda) = T^{-1} \left(1 + \frac{2T}{\lambda}\right) \sum_{t=1}^{T}(y_t - g_t)^2</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>t</mi></msub><annotation encoding="application/x-tex">g_t</annotation></semantics></math>
is the estimated trend for a given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the number of observations.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"myaseen208/mhpfilter"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://myaseen208.com/mhpfilter/">mhpfilter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="example-1-gdp-like-series">Example 1: GDP-like Series<a class="anchor" aria-label="anchor" href="#example-1-gdp-like-series"></a>
</h3>
<p>Let’s start with a simulated series that resembles real GDP data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">120</span>  <span class="co"># 30 years of quarterly data</span></span>
<span></span>
<span><span class="co"># Generate components</span></span>
<span><span class="va">trend_growth</span> <span class="op">&lt;-</span> <span class="fl">0.005</span>  <span class="co"># 0.5% quarterly growth</span></span>
<span><span class="va">trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="va">trend_growth</span>, sd <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Business cycle: AR(2) process</span></span>
<span><span class="va">cycle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, <span class="va">n</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed GDP (in logs)</span></span>
<span><span class="va">gdp</span> <span class="op">&lt;-</span> <span class="va">trend</span> <span class="op">+</span> <span class="va">cycle</span></span>
<span></span>
<span><span class="co"># Apply Modified HP filter</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal lambda:"</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal lambda: 4337</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"GCV value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_gcv.html">get_gcv</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; GCV value: 14.36</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization-with-autoplot">Visualization with autoplot<a class="anchor" aria-label="anchor" href="#visualization-with-autoplot"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span>, as_dt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">result_obj</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Modified HP Filter Decomposition of Simulated GDP"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Optimal λ = "</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result_obj</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/autoplot-example-1.png" class="r-plt" alt="Figure 1: Modified HP Filter Decomposition" width="768"><p class="caption">
Figure 1: Modified HP Filter Decomposition
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-standard-hp-filter">Comparison with Standard HP Filter<a class="anchor" aria-label="anchor" href="#comparison-with-standard-hp-filter"></a>
</h2>
<p>One of the key features of <code>mhpfilter</code> is the ability to
compare results with the standard HP filter:</p>
<div class="section level3">
<h3 id="example-2-why-fixed-lambda-matters">Example 2: Why Fixed Lambda Matters<a class="anchor" aria-label="anchor" href="#example-2-why-fixed-lambda-matters"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply both filters</span></span>
<span><span class="va">mhp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">hp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp_filter.html">hp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, lambda <span class="op">=</span> <span class="fl">1600</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract key statistics</span></span>
<span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_compare.html">mhp_compare</a></span><span class="op">(</span><span class="va">gdp</span>, frequency <span class="op">=</span> <span class="st">"quarterly"</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span></span>
<span><span class="co">#&gt;         method lambda cycle_sd    cycle_mean       ar1 cycle_range      gcv</span></span>
<span><span class="co">#&gt;         &lt;char&gt;  &lt;num&gt;    &lt;num&gt;         &lt;num&gt;     &lt;num&gt;       &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:          HP   1600 3.572060  3.114072e-12 0.7922935    18.43100       NA</span></span>
<span><span class="co">#&gt; 2: Modified HP   4337 3.704804 -1.247583e-11 0.8040480    19.11926 14.36441</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visual-comparison">Visual Comparison<a class="anchor" aria-label="anchor" href="#visual-comparison"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_comparison.html">plot_comparison</a></span><span class="op">(</span><span class="va">gdp</span>, frequency <span class="op">=</span> <span class="st">"quarterly"</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span>, show_cycle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.box <span class="op">=</span> <span class="st">"vertical"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/comparison-plot-1.png" class="r-plt" alt="Figure 2: HP vs Modified HP Filter Comparison" width="768"><p class="caption">
Figure 2: HP vs Modified HP Filter Comparison
</p>
</div>
</div>
<div class="section level3">
<h3 id="key-insights-from-comparison">Key Insights from Comparison<a class="anchor" aria-label="anchor" href="#key-insights-from-comparison"></a>
</h3>
<p>The comparison reveals important differences:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optimal lambda from MHP</span></span>
<span><span class="va">opt_lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">mhp_res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal λ (Modified HP):"</span>, <span class="va">opt_lambda</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal λ (Modified HP): 4337</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fixed λ (Standard HP):  1600\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fixed λ (Standard HP):  1600</span></span>
<span></span>
<span><span class="co"># Cyclical volatility</span></span>
<span><span class="va">sd_mhp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mhp_res</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span></span>
<span><span class="va">sd_hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hp_res</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cycle SD (Modified HP):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd_mhp</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cycle SD (Modified HP): 3.705</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cycle SD (Standard HP):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd_hp</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cycle SD (Standard HP): 3.572</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Difference:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd_mhp</span> <span class="op">-</span> <span class="va">sd_hp</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">sd_mhp</span> <span class="op">-</span> <span class="va">sd_hp</span><span class="op">)</span> <span class="op">/</span> <span class="va">sd_hp</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%)"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Difference: 0.133 (3.7%)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="batch-processing-multi-country-analysis">Batch Processing: Multi-Country Analysis<a class="anchor" aria-label="anchor" href="#batch-processing-multi-country-analysis"></a>
</h2>
<p>A powerful feature is batch processing multiple series
simultaneously. This is particularly useful for cross-country
macroeconomic comparisons.</p>
<div class="section level3">
<h3 id="example-3-cross-country-gdp-comparison">Example 3: Cross-Country GDP Comparison<a class="anchor" aria-label="anchor" href="#example-3-cross-country-gdp-comparison"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">n_time</span> <span class="op">&lt;-</span> <span class="fl">100</span>  <span class="co"># 25 years quarterly</span></span>
<span></span>
<span><span class="co"># Simulate GDP for multiple countries with different characteristics</span></span>
<span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USA"</span>, <span class="st">"Germany"</span>, <span class="st">"Japan"</span>, <span class="st">"China"</span>, <span class="st">"Brazil"</span>, <span class="st">"India"</span><span class="op">)</span></span>
<span><span class="va">characteristics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  country <span class="op">=</span> <span class="va">countries</span>,</span>
<span>  trend_growth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">1.5</span>, <span class="fl">0.6</span>, <span class="fl">1.2</span><span class="op">)</span>,  <span class="co"># % quarterly</span></span>
<span>  trend_vol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  cycle_vol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.0</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">2.0</span><span class="op">)</span>,</span>
<span>  cycle_ar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.88</span>, <span class="fl">0.90</span>, <span class="fl">0.75</span>, <span class="fl">0.70</span>, <span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data</span></span>
<span><span class="va">gdp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">characteristics</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">char</span> <span class="op">&lt;-</span> <span class="va">characteristics</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">trend</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_time</span>, </span>
<span>                               mean <span class="op">=</span> <span class="va">char</span><span class="op">$</span><span class="va">trend_growth</span> <span class="op">/</span> <span class="fl">100</span>, </span>
<span>                               sd <span class="op">=</span> <span class="va">char</span><span class="op">$</span><span class="va">trend_vol</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">cycle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="va">char</span><span class="op">$</span><span class="va">cycle_ar</span><span class="op">)</span>, <span class="va">n_time</span>, sd <span class="op">=</span> <span class="va">char</span><span class="op">$</span><span class="va">cycle_vol</span><span class="op">)</span></span>
<span>  <span class="va">trend</span> <span class="op">+</span> <span class="va">cycle</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gdp_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">countries</span></span>
<span></span>
<span><span class="co"># Apply Modified HP filter to all countries</span></span>
<span><span class="va">batch_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_batch.html">mhp_batch</a></span><span class="op">(</span><span class="va">gdp_data</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View optimal lambdas</span></span>
<span><span class="va">lambdas_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">batch_result</span>, <span class="st">"lambdas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lambdas_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;     series lambda      gcv</span></span>
<span><span class="co">#&gt;     &lt;char&gt;  &lt;int&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     USA    566 3.647804</span></span>
<span><span class="co">#&gt; 2: Germany    505 3.096862</span></span>
<span><span class="co">#&gt; 3:   Japan    389 1.812784</span></span>
<span><span class="co">#&gt; 4:   China   1289 7.544833</span></span>
<span><span class="co">#&gt; 5:  Brazil   1739 9.723271</span></span>
<span><span class="co">#&gt; 6:   India   1464 5.676737</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-cross-country-cycles">Visualizing Cross-Country Cycles<a class="anchor" aria-label="anchor" href="#visualizing-cross-country-cycles"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_batch.html">plot_batch</a></span><span class="op">(</span><span class="va">batch_result</span>, show <span class="op">=</span> <span class="st">"cycle"</span>, facet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Business Cycle Components: Cross-Country Comparison"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Modified HP Filter with Country-Specific λ"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Note: Each country has its own optimal smoothing parameter"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray95"</span>, color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/batch-cycles-plot-1.png" class="r-plt" alt="Figure 3: Business Cycles Across Countries" width="768"><p class="caption">
Figure 3: Business Cycles Across Countries
</p>
</div>
</div>
<div class="section level3">
<h3 id="highlighting-specific-countries">Highlighting Specific Countries<a class="anchor" aria-label="anchor" href="#highlighting-specific-countries"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_batch.html">plot_batch</a></span><span class="op">(</span><span class="va">batch_result</span>, show <span class="op">=</span> <span class="st">"cycle"</span>, facet <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>           highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USA"</span>, <span class="st">"China"</span>, <span class="st">"India"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Business Cycles: Advanced vs Emerging Economies"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"USA (developed) vs China &amp; India (emerging markets)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Country (λ)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/batch-highlight-plot-1.png" class="r-plt" alt="Figure 4: Highlighted Comparison" width="768"><p class="caption">
Figure 4: Highlighted Comparison
</p>
</div>
</div>
<div class="section level3">
<h3 id="batch-comparison-with-standard-hp">Batch Comparison with Standard HP<a class="anchor" aria-label="anchor" href="#batch-comparison-with-standard-hp"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/batch_compare.html">batch_compare</a></span><span class="op">(</span><span class="va">gdp_data</span>, frequency <span class="op">=</span> <span class="st">"quarterly"</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt;     series hp_lambda mhp_lambda hp_cycle_sd mhp_cycle_sd     sd_diff    hp_ar1</span></span>
<span><span class="co">#&gt;     &lt;char&gt;     &lt;num&gt;      &lt;int&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     USA      1600        566    1.849002     1.650031 -0.19897143 0.6777133</span></span>
<span><span class="co">#&gt; 2: Germany      1600        505    1.728567     1.496906 -0.23166103 0.7346829</span></span>
<span><span class="co">#&gt; 3:   Japan      1600        389    1.357226     1.099696 -0.25753039 0.7784002</span></span>
<span><span class="co">#&gt; 4:   China      1600       1289    2.606722     2.568540 -0.03818215 0.5954362</span></span>
<span><span class="co">#&gt; 5:  Brazil      1600       1739    2.955147     2.967902  0.01275438 0.5726763</span></span>
<span><span class="co">#&gt; 6:   India      1600       1464    2.258162     2.246082 -0.01207980 0.5016707</span></span>
<span><span class="co">#&gt;      mhp_ar1     ar1_diff relative_sd</span></span>
<span><span class="co">#&gt;        &lt;num&gt;        &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 0.6111909 -0.066522391   0.8923898</span></span>
<span><span class="co">#&gt; 2: 0.6598704 -0.074812412   0.8659809</span></span>
<span><span class="co">#&gt; 3: 0.6723097 -0.106090519   0.8102524</span></span>
<span><span class="co">#&gt; 4: 0.5828127 -0.012623423   0.9853524</span></span>
<span><span class="co">#&gt; 5: 0.5760828  0.003406520   1.0043160</span></span>
<span><span class="co">#&gt; 6: 0.4965493 -0.005121396   0.9946506</span></span>
<span></span>
<span><span class="co"># Analyze differences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSummary of Lambda Differences:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of Lambda Differences:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean optimal λ:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean optimal λ: NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fixed λ (HP):  1600\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fixed λ (HP):  1600</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Range of optimal λ:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"["</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, <span class="st">", "</span>, </span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Range of optimal λ: [Inf, -Inf]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Countries with λ &gt; 2000:"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">series</span><span class="op">[</span><span class="va">comparison</span><span class="op">$</span><span class="va">lambda</span> <span class="op">&gt;</span> <span class="fl">2000</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Countries with λ &gt; 2000:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Countries with λ &lt; 1000:"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">series</span><span class="op">[</span><span class="va">comparison</span><span class="op">$</span><span class="va">lambda</span> <span class="op">&lt;</span> <span class="fl">1000</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Countries with λ &lt; 1000:</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-4-real-business-cycle-analysis">Example 4: Real Business Cycle Analysis<a class="anchor" aria-label="anchor" href="#example-4-real-business-cycle-analysis"></a>
</h2>
<p>Demonstrating how the Modified HP filter affects business cycle
statistics:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Focus on one country for detailed analysis</span></span>
<span><span class="va">usa_gdp</span> <span class="op">&lt;-</span> <span class="va">gdp_data</span><span class="op">[</span>, <span class="st">"USA"</span><span class="op">]</span></span>
<span><span class="va">usa_mhp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">usa_gdp</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span>, as_dt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">usa_hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp_filter.html">hp_filter</a></span><span class="op">(</span><span class="va">usa_gdp</span>, lambda <span class="op">=</span> <span class="fl">1600</span>, as_dt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison data.table</span></span>
<span><span class="va">bc_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Modified HP"</span>, <span class="st">"Standard HP"</span><span class="op">)</span>,</span>
<span>  Lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">lambda</span>, <span class="fl">1600</span><span class="op">)</span>,</span>
<span>  `Mean Cycle` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `SD Cycle` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Min Cycle` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Max Cycle` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `AR(1) Coef` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bc_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Method Lambda    Mean Cycle SD Cycle Min Cycle Max Cycle AR(1) Coef</span></span>
<span><span class="co">#&gt;         &lt;char&gt;  &lt;num&gt;         &lt;num&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: Modified HP    566 -6.454571e-13 1.650031 -4.132040  3.671701   0.613421</span></span>
<span><span class="co">#&gt; 2: Standard HP   1600  5.820198e-12 1.849002 -4.743509  3.497196   0.683282</span></span></code></pre></div>
<div class="section level3">
<h3 id="cyclical-properties-visualization">Cyclical Properties Visualization<a class="anchor" aria-label="anchor" href="#cyclical-properties-visualization"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_time</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  Cycle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">usa_mhp</span><span class="op">$</span><span class="va">cycle</span>, <span class="va">usa_hp</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span>,</span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Modified HP"</span>, <span class="st">"Standard HP"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_time</span><span class="op">)</span>,</span>
<span>  Lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"λ = "</span>, <span class="va">usa_mhp</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, <span class="st">"λ = 1600"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_time</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Cycle</span>, color <span class="op">=</span> <span class="va">Method</span>, linetype <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray60"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Modified HP"</span> <span class="op">=</span> <span class="st">"#0072B2"</span>, <span class="st">"Standard HP"</span> <span class="op">=</span> <span class="st">"#D55E00"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Modified HP"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"Standard HP"</span> <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Business Cycle Components: Method Comparison"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Modified HP filter allows for data-driven smoothing"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time Period (Quarters)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cyclical Component"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    linetype <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/cycle-properties-1.png" class="r-plt" alt="Figure 5: Cyclical Properties Comparison" width="768"><p class="caption">
Figure 5: Cyclical Properties Comparison
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-5-sensitivity-to-lambda">Example 5: Sensitivity to Lambda<a class="anchor" aria-label="anchor" href="#example-5-sensitivity-to-lambda"></a>
</h2>
<p>Demonstrating why optimal lambda selection matters:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Try different lambda values</span></span>
<span><span class="va">lambdas_to_try</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">400</span>, <span class="fl">1600</span>, <span class="fl">6400</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">mhp_res</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lambda_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lambdas_to_try</span>, <span class="kw">function</span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp_filter.html">hp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, lambda <span class="op">=</span> <span class="va">lam</span>, as_dt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>    Time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gdp</span><span class="op">)</span>,</span>
<span>    Original <span class="op">=</span> <span class="va">gdp</span>,</span>
<span>    Trend <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">trend</span>,</span>
<span>    Cycle <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">cycle</span>,</span>
<span>    Lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"λ = "</span>, <span class="va">lam</span><span class="op">)</span>,</span>
<span>    Is_Optimal <span class="op">=</span> <span class="va">lam</span> <span class="op">==</span> <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">mhp_res</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">sens_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">lambda_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot trends</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sens_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Original</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"gray60"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Trend</span>, color <span class="op">=</span> <span class="va">Is_Optimal</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Lambda</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"#D55E00"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"#0072B2"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sub-optimal"</span>, <span class="st">"Optimal (MHP)"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Effect of Lambda on Trend Estimation"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Lower λ = less smooth (overfitting), Higher λ = too smooth (underfitting)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time Period"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Gray line shows original series"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray95"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/lambda-sensitivity-1.png" class="r-plt" alt="Figure 6: Sensitivity to Lambda Choice" width="768"><p class="caption">
Figure 6: Sensitivity to Lambda Choice
</p>
</div>
</div>
<div class="section level2">
<h2 id="performance-tips">Performance Tips<a class="anchor" aria-label="anchor" href="#performance-tips"></a>
</h2>
<div class="section level3">
<h3 id="choosing-max_lambda">Choosing max_lambda<a class="anchor" aria-label="anchor" href="#choosing-max_lambda"></a>
</h3>
<p>The <code>max_lambda</code> parameter determines the search
range:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For most macroeconomic applications</span></span>
<span><span class="va">result_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Standard search (max_lambda=10000):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Standard search (max_lambda=10000):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Optimal λ:"</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result_standard</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Optimal λ: 4337</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  GCV:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_gcv.html">get_gcv</a></span><span class="op">(</span><span class="va">result_standard</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   GCV: 14.36</span></span>
<span></span>
<span><span class="co"># For very smooth trends or unusual series</span></span>
<span><span class="va">result_extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">gdp</span>, max_lambda <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Extended search (max_lambda=50000):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Extended search (max_lambda=50000):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Optimal λ:"</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result_extended</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Optimal λ: 4337</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  GCV:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_gcv.html">get_gcv</a></span><span class="op">(</span><span class="va">result_extended</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   GCV: 14.36</span></span>
<span></span>
<span><span class="co"># Check if we're near the boundary</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result_standard</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.95</span> <span class="op">*</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"WARNING: Optimal λ near upper bound. Consider increasing max_lambda.\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="batch-processing-efficiency">Batch Processing Efficiency<a class="anchor" aria-label="anchor" href="#batch-processing-efficiency"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Efficient for multiple series</span></span>
<span><span class="va">large_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">50</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">batch_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_batch.html">mhp_batch</a></span><span class="op">(</span><span class="va">large_dataset</span>, max_lambda <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Less efficient: loop over columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">manual_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">large_dataset</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, max_lambda <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary-and-recommendations">Summary and Recommendations<a class="anchor" aria-label="anchor" href="#summary-and-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="when-to-use-modified-hp-filter">When to Use Modified HP Filter<a class="anchor" aria-label="anchor" href="#when-to-use-modified-hp-filter"></a>
</h3>
<p><strong>✓ Recommended for:</strong></p>
<ul>
<li>Cross-country macroeconomic comparisons</li>
<li>Analysis of different economic variables (GDP, consumption,
investment)</li>
<li>Uncertain about appropriate λ for your context</li>
<li>Need defensible, data-driven parameter selection</li>
<li>Comparing business cycles across countries with different
volatility</li>
</ul>
<p><strong>Standard HP may suffice when:</strong></p>
<ul>
<li>Replicating published studies using fixed λ</li>
<li>U.S. quarterly GDP analysis matching original HP (1997) context</li>
<li>Speed is critical and λ = 1600 is demonstrably appropriate</li>
</ul>
</div>
<div class="section level3">
<h3 id="key-takeaways">Key Takeaways<a class="anchor" aria-label="anchor" href="#key-takeaways"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Optimal λ varies substantially</strong> across countries and
variables</li>
<li>
<strong>Fixed λ may mis-assign variation</strong> to trend vs
cycle</li>
<li>
<strong>Modified HP filter provides data-driven selection</strong>
via GCV</li>
<li><strong>Batch processing enables efficient multi-series
analysis</strong></li>
<li>
<strong>Visualization tools help understand differences</strong>
between methods</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Choudhary, M.A., Hanif, M.N., &amp; Iqbal, J. (2014). On
smoothing macroeconomic time series using the modified HP filter.
<em>Applied Economics</em>, 46(19), 2205-2214. <a href="https://doi.org/10.1080/00036846.2014.896982" class="external-link uri">https://doi.org/10.1080/00036846.2014.896982</a></p></li>
<li><p>Hodrick, R.J., &amp; Prescott, E.C. (1997). Postwar US business
cycles: An empirical investigation. <em>Journal of Money, Credit and
Banking</em>, 29(1), 1-16.</p></li>
<li><p>McDermott, C.J. (1997). An automatic method for choosing the
smoothing parameter in the HP filter. Unpublished manuscript,
International Monetary Fund.</p></li>
<li><p>Ravn, M.O., &amp; Uhlig, H. (2002). On adjusting the
Hodrick-Prescott filter for the frequency of observations. <em>Review of
Economics and Statistics</em>, 84(2), 371-376.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<code><a href="../articles/methodology.html">vignette("methodology", package = "mhpfilter")</a></code> -
Detailed mathematical theory</li>
<li>
<code><a href="../reference/mhp_filter.html">?mhp_filter</a></code> - Main filtering function</li>
<li>
<code><a href="../reference/mhp_batch.html">?mhp_batch</a></code> - Batch processing</li>
<li>
<code><a href="../reference/mhp_compare.html">?mhp_compare</a></code> - Comparison tools</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.researchgate.net/profile/Muhammad_Yaseen10" class="external-link">Muhammad Yaseen</a>. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Licensed under <a href="https://opensource.org/licenses/MIT" class="external-link">MIT License</a> Please cite: <a href="https://doi.org/10.1080/00036846.2014.894631" class="external-link">Choudhary, Hanif &amp; Iqbal (2014)</a> “On smoothing macroeconomic time series using the modified HP filter.” Applied Economics, 46(19), 2205-2214.</p>
</div>

    </footer>
</div>





  </body>
</html>
