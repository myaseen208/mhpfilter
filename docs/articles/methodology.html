<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modified HP Filter: Theory and Methodology • mhpfilter</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modified HP Filter: Theory and Methodology">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mhpfilter</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html"><span class="fa fa-file-text-o"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to mhpfilter</a></li>
    <li><a class="dropdown-item" href="../articles/methodology.html">Mathematical Methodology</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/myaseen208/mhpfilter" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cran.r-project.org/package=mhpfilter" aria-label="CRAN"><span class="fa fa-download"></span> CRAN</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.researchgate.net/profile/Muhammad_Yaseen10" aria-label="ResearchGate"><span class="fa fa-graduation-cap"></span> ResearchGate</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/myaseen208" aria-label="Twitter"><span class="fa fab fa-twitter"></span> Twitter</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Modified HP Filter: Theory and Methodology</h1>
                        <h4 data-toc-skip class="author">Muhammad
Yaseen</h4>
            <address class="author_afil">
      School of Mathematical and Statistical Sciences, Clemson
University<br><a class="author_email" href="mailto:#"></a><a href="mailto:myaseen208@gmail.com" class="email">myaseen208@gmail.com</a>
      </address>
                              <h4 data-toc-skip class="author">Javed
Iqbal</h4>
            <address class="author_afil">
      State Bank of
Pakistan<br><a class="author_email" href="mailto:#"></a><a href="mailto:Javed.iqbal6@sbp.org.pk" class="email">Javed.iqbal6@sbp.org.pk</a>
      </address>
                              <h4 data-toc-skip class="author">M. Nadim
Hanif</h4>
            <address class="author_afil">
      State Bank of
Pakistan<br><a class="author_email" href="mailto:#"></a><a href="mailto:Nadeem.hanif@sbp.org.pk" class="email">Nadeem.hanif@sbp.org.pk</a>
      </address>
                  
            <h4 data-toc-skip class="date">2026-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/myaseen208/mhpfilter/blob/main/vignettes/methodology.Rmd" class="external-link"><code>vignettes/methodology.Rmd</code></a></small>
      <div class="d-none name"><code>methodology.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides a detailed explanation of the methodology
underlying the Modified Hodrick-Prescott (HP) filter as implemented in
the <code>mhpfilter</code> package. We cover the mathematical
foundations, the cross-validation approach for optimal parameter
selection, and empirical evidence supporting its use.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/myaseen208/mhpfilter" class="external-link">mhpfilter</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; mhpfilter 0.1.0 loaded</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fastverse.github.io/fastverse/" class="external-link">fastverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; -- <span style="font-weight: bold;">Attaching packages</span> --------------------------------------- <span style="color: #0087FF;">fastverse</span> 0.3.4 --</span></span>
<span><span class="co">#&gt; <span style="color: #0087FF;">v</span> <span style="color: #FF0087;">data.table</span> 1.18.2.1     <span style="color: #0087FF;">v</span> <span style="color: #FF0087;">kit       </span> 0.0.21  </span></span>
<span><span class="co">#&gt; <span style="color: #0087FF;">v</span> <span style="color: #FF0087;">magrittr  </span> 2.0.4        <span style="color: #0087FF;">v</span> <span style="color: #FF0087;">collapse  </span> 2.1.6</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.2.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.6</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.6.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 4.0.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.5     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.2</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.2.1</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">between()</span>     masks <span style="color: #0000BB;">data.table</span>::between()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">count()</span>       masks <span style="color: #0000BB;">kit</span>::count()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">extract()</span>     masks <span style="color: #0000BB;">magrittr</span>::extract()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>      masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">first()</span>       masks <span style="color: #0000BB;">data.table</span>::first()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">hour()</span>    masks <span style="color: #0000BB;">data.table</span>::hour()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">isoweek()</span> masks <span style="color: #0000BB;">data.table</span>::isoweek()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">isoyear()</span> masks <span style="color: #0000BB;">data.table</span>::isoyear()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>         masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">last()</span>        masks <span style="color: #0000BB;">data.table</span>::last()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">mday()</span>    masks <span style="color: #0000BB;">data.table</span>::mday()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">minute()</span>  masks <span style="color: #0000BB;">data.table</span>::minute()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">month()</span>   masks <span style="color: #0000BB;">data.table</span>::month()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">quarter()</span> masks <span style="color: #0000BB;">data.table</span>::quarter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">replace_na()</span>  masks <span style="color: #0000BB;">collapse</span>::replace_na()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">second()</span>  masks <span style="color: #0000BB;">data.table</span>::second()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">set_names()</span>   masks <span style="color: #0000BB;">magrittr</span>::set_names()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">transpose()</span>   masks <span style="color: #0000BB;">data.table</span>::transpose()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">wday()</span>    masks <span style="color: #0000BB;">data.table</span>::wday()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">week()</span>    masks <span style="color: #0000BB;">data.table</span>::week()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">yday()</span>    masks <span style="color: #0000BB;">data.table</span>::yday()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">year()</span>    masks <span style="color: #0000BB;">data.table</span>::year()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-standard-hp-filter">1. The Standard HP Filter<a class="anchor" aria-label="anchor" href="#the-standard-hp-filter"></a>
</h2>
<div class="section level3">
<h3 id="problem-formulation">1.1 Problem Formulation<a class="anchor" aria-label="anchor" href="#problem-formulation"></a>
</h3>
<p>The Hodrick-Prescott (1997) filter decomposes a time series
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">y_t</annotation></semantics></math>
into a trend component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>t</mi></msub><annotation encoding="application/x-tex">g_t</annotation></semantics></math>
and a cyclical component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>t</mi></msub><annotation encoding="application/x-tex">c_t</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>g</mi><mi>t</mi></msub><mo>+</mo><msub><mi>c</mi><mi>t</mi></msub><mo>,</mo><mspace width="1.0em"></mspace><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">y_t = g_t + c_t, \quad t = 1, 2, \ldots, T</annotation></semantics></math></p>
<p>The filter estimates the trend by solving the optimization
problem:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>min</mo><msub><mi>g</mi><mi>t</mi></msub></munder><mrow><mo stretchy="true" form="prefix">{</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>−</mo><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>λ</mi><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>3</mn></mrow><mi>T</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>g</mi><mi>t</mi></msub><mo>−</mo><msub><mi>g</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>g</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>g</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\min_{g_t} \left\{ \sum_{t=1}^{T}(y_t - g_t)^2 + \lambda \sum_{t=3}^{T}[(g_t - g_{t-1}) - (g_{t-1} - g_{t-2})]^2 \right\}</annotation></semantics></math></p>
<p>This objective function balances two competing goals:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Goodness of fit</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>−</mo><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_{t=1}^{T}(y_t - g_t)^2</annotation></semantics></math>
- the trend should be close to the data</li>
<li>
<strong>Smoothness</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>3</mn></mrow><mi>T</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Δ</mi><mn>2</mn></msup><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_{t=3}^{T}(\Delta^2 g_t)^2</annotation></semantics></math>
- the trend’s growth rate should not change too rapidly</li>
</ol>
<p>The smoothing parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
controls the trade-off:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda \to 0</annotation></semantics></math>:
Trend equals original series (no smoothing)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>→</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">\lambda \to \infty</annotation></semantics></math>:
Trend is a linear time trend (maximum smoothing)</li>
</ul>
</div>
<div class="section level3">
<h3 id="matrix-formulation">1.2 Matrix Formulation<a class="anchor" aria-label="anchor" href="#matrix-formulation"></a>
</h3>
<p>The solution can be expressed in matrix form. Define the
second-difference operator matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">(T-2) \times T</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K = \begin{pmatrix}
1 &amp; -2 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 1 &amp; -2 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; 0 &amp; 1 &amp; -2 &amp; 1
\end{pmatrix}</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>K</mi><mi>′</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">A = K'K</annotation></semantics></math>.
Then the HP filter solution is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>g</mi><mo accent="true">̂</mo></mover><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>+</mo><mi>λ</mi><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">\hat{g} = (I + \lambda A)^{-1} y</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>×</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">T \times T</annotation></semantics></math>
identity matrix.</p>
</div>
<div class="section level3">
<h3 id="the-problem-with-fixed-lambda">1.3 The Problem with Fixed Lambda<a class="anchor" aria-label="anchor" href="#the-problem-with-fixed-lambda"></a>
</h3>
<p>Hodrick and Prescott (1997) recommended
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1600</mn></mrow><annotation encoding="application/x-tex">\lambda = 1600</annotation></semantics></math>
for quarterly U.S. GDP data, based on the assumption that:</p>
<blockquote>
<p>“A 5 percent cyclical component is moderately large, as is one-eighth
of 1 percent change in the growth rate in a quarter.”</p>
</blockquote>
<p>This led to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mi>/</mi><mn>0.125</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><mn>1600</mn></mrow><annotation encoding="application/x-tex">\lambda = (5 / 0.125)^2 = 1600</annotation></semantics></math>.</p>
<p>However, this assumption may not hold for:</p>
<ul>
<li>Different countries (emerging markets have more volatile
cycles)</li>
<li>Different series (investment is more volatile than consumption)</li>
<li>Different time periods (Great Moderation vs earlier periods)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lambdas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">400</span>, <span class="fl">1600</span>, <span class="fl">6400</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame for all lambda values</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">lam</span> <span class="kw">in</span> <span class="va">lambdas</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp_filter.html">hp_filter</a></span><span class="op">(</span><span class="va">y</span>, lambda <span class="op">=</span> <span class="va">lam</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">temp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">result</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span>,</span>
<span>    series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"Trend"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"λ ="</span>, <span class="va">lam</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">temp_data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create faceted plot with combined legend</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">series</span>, linewidth <span class="op">=</span> <span class="va">series</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"Trend"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linewidth_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span> <span class="op">=</span> <span class="fl">0.7</span>, <span class="st">"Trend"</span> <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">lambda</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Value"</span>, color <span class="op">=</span> <span class="st">"Series"</span>, linewidth <span class="op">=</span> <span class="st">"Series"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="methodology_files/figure-html/lambda-effect-1.png" class="r-plt" alt="Effect of Lambda on Trend Smoothness" width="672"><p class="caption">
Effect of Lambda on Trend Smoothness
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-modified-hp-filter">2. The Modified HP Filter<a class="anchor" aria-label="anchor" href="#the-modified-hp-filter"></a>
</h2>
<div class="section level3">
<h3 id="cross-validation-approach">2.1 Cross-Validation Approach<a class="anchor" aria-label="anchor" href="#cross-validation-approach"></a>
</h3>
<p>The Modified HP filter, developed by McDermott (1997) and applied
empirically by Choudhary, Hanif &amp; Iqbal (2014), selects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
using <strong>generalized cross-validation (GCV)</strong>.</p>
<p>The idea is based on leave-one-out cross-validation:</p>
<ol style="list-style-type: decimal">
<li>For each observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
fit the HP filter to all data <em>except</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>k</mi></msub><annotation encoding="application/x-tex">y_k</annotation></semantics></math>
</li>
<li>Predict the left-out observation using the fitted trend</li>
<li>Choose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
that minimizes the average prediction error</li>
</ol>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mrow><mi>T</mi><mo>,</mo><mi>λ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_{T,\lambda}^{(k)}(t_k)</annotation></semantics></math>
denote the predicted value at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
from the spline fitted leaving out observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
The cross-validation function is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msubsup><mi>g</mi><mrow><mi>T</mi><mo>,</mo><mi>λ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">CV(\lambda) = \frac{1}{T} \sum_{k=1}^{T} \left(y_k - g_{T,\lambda}^{(k)}(t_k)\right)^2</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="generalized-cross-validation">2.2 Generalized Cross-Validation<a class="anchor" aria-label="anchor" href="#generalized-cross-validation"></a>
</h3>
<p>Computing the leave-one-out CV is computationally intensive. Craven
&amp; Wahba (1979) showed it can be approximated by the
<strong>generalized cross-validation</strong> (GCV) function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msubsup><mi>g</mi><mrow><mi>t</mi><mo>,</mo><mi>k</mi></mrow><mi>λ</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><mtext mathvariant="normal">tr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">GCV(\lambda) = \frac{T^{-1} \sum_{k=1}^{T}(y_k - g_{t,k}^\lambda)^2}{\left(1 - \frac{1}{T}\text{tr}(B(\lambda))\right)^2}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>+</mo><mi>λ</mi><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B(\lambda) = (I + \lambda A)^{-1}</annotation></semantics></math>
is the “hat matrix” and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mrow><mi>t</mi><mo>,</mo><mi>k</mi></mrow><mi>λ</mi></msubsup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>b</mi><mrow><mi>k</mi><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>y</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">g_{t,k}^\lambda = \sum_{s=1}^{T} b_{ks}(\lambda) y_s</annotation></semantics></math>.</p>
<p>Using Silverman’s (1984) approximation for the trace:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">tr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mi>T</mi><mi>λ</mi></mfrac></mrow><annotation encoding="application/x-tex">\text{tr}(B(\lambda)) \approx \frac{T}{\lambda}</annotation></semantics></math></p>
<p>This yields the simplified GCV formula used in this package:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mn>2</mn><mi>T</mi></mrow><mi>λ</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msubsup><mi>g</mi><mrow><mi>t</mi><mo>,</mo><mi>k</mi></mrow><mi>λ</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">GCV(\lambda) = T^{-1} \left(1 + \frac{2T}{\lambda}\right) \sum_{k=1}^{T}(y_k - g_{t,k}^\lambda)^2</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="algorithm">2.3 Algorithm<a class="anchor" aria-label="anchor" href="#algorithm"></a>
</h3>
<p>The algorithm implemented in <code>mhpfilter</code> is:</p>
<ol style="list-style-type: decimal">
<li>Compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>K</mi><mi>′</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">A = K'K</annotation></semantics></math>
once (shared across all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
values)</li>
<li>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>λ</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lambda = 1, 2, \ldots, \lambda_{max}</annotation></semantics></math>:
<ul>
<li>Compute trend:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>+</mo><mi>λ</mi><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">g = (I + \lambda A)^{-1} y</annotation></semantics></math>
</li>
<li>Compute residuals:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mi>y</mi><mo>−</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">r = y - g</annotation></semantics></math>
</li>
<li>Compute GCV:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>T</mi><mi>/</mi><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>r</mi><mi>′</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">GCV(\lambda) = T^{-1}(1 + 2T/\lambda) \cdot r'r</annotation></semantics></math>
</li>
</ul>
</li>
<li>Select
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>λ</mi><mo>*</mo></msup><mo>=</mo><mo>arg</mo><msub><mo>min</mo><mi>λ</mi></msub><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda^* = \arg\min_\lambda GCV(\lambda)</annotation></semantics></math>
</li>
<li>Return final decomposition using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>λ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\lambda^*</annotation></semantics></math>
</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute GCV for range of lambdas</span></span>
<span><span class="va">lambdas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5000</span>, by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">gcv_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">lambdas</span>, <span class="kw">function</span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp_filter.html">hp_filter</a></span><span class="op">(</span><span class="va">y</span>, lambda <span class="op">=</span> <span class="va">lam</span>, as_dt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">resid_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">res</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="cn">T</span><span class="op">/</span><span class="va">lam</span><span class="op">)</span> <span class="op">*</span> <span class="va">resid_ss</span> <span class="op">/</span> <span class="cn">T</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  lambda <span class="op">=</span> <span class="va">lambdas</span>,</span>
<span>  gcv <span class="op">=</span> <span class="va">gcv_values</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find minimum</span></span>
<span><span class="va">opt_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">gcv_values</span><span class="op">)</span></span>
<span><span class="va">opt_lambda</span> <span class="op">&lt;-</span> <span class="va">lambdas</span><span class="op">[</span><span class="va">opt_idx</span><span class="op">]</span></span>
<span><span class="va">opt_gcv</span> <span class="op">&lt;-</span> <span class="va">gcv_values</span><span class="op">[</span><span class="va">opt_idx</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create ggplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lambda</span>, y <span class="op">=</span> <span class="va">gcv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">opt_lambda</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="va">opt_lambda</span>, gcv <span class="op">=</span> <span class="va">opt_gcv</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lambda</span>, y <span class="op">=</span> <span class="va">gcv</span><span class="op">)</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Corrected: Use annotate() instead of geom_label() with aes()</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"label"</span>,</span>
<span>           x <span class="op">=</span> <span class="va">opt_lambda</span> <span class="op">+</span> <span class="fl">500</span>, </span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">gcv_values</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.95</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Optimal λ ="</span>, <span class="va">opt_lambda</span><span class="op">)</span>,</span>
<span>           color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"GCV"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Generalized Cross-Validation Function"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="methodology_files/figure-html/gcv-curve-1.png" class="r-plt" alt="GCV as a Function of Lambda" width="672"><p class="caption">
GCV as a Function of Lambda
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="why-modified-hp-filter-works-better">3. Why Modified HP Filter Works Better<a class="anchor" aria-label="anchor" href="#why-modified-hp-filter-works-better"></a>
</h2>
<div class="section level3">
<h3 id="simulation-evidence">3.1 Simulation Evidence<a class="anchor" aria-label="anchor" href="#simulation-evidence"></a>
</h3>
<p>Choudhary et al. (2014) conducted Monte Carlo simulations comparing
the standard HP filter with the Modified HP filter. The data generating
process was:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>t</mi></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>g</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>ε</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>ε</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_t = \mu + g_{t-1} + \varepsilon_t, \quad \varepsilon_t \sim N(0, \sigma_\varepsilon^2)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>c</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ϕ</mi><mn>2</mn></msub><msub><mi>c</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>ξ</mi><mi>t</mi></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>ξ</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>ξ</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_t = \phi_1 c_{t-1} + \phi_2 c_{t-2} + \xi_t, \quad \xi_t \sim N(0, \sigma_\xi^2)</annotation></semantics></math></p>
<p>They varied:</p>
<ul>
<li>The ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>ε</mi></msub><mi>/</mi><msub><mi>σ</mi><mi>ξ</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_\varepsilon / \sigma_\xi</annotation></semantics></math>
(relative importance of trend vs cycle)</li>
<li>AR coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1, \phi_2</annotation></semantics></math>
(cycle persistence)</li>
<li>Linear vs nonlinear trend specifications</li>
</ul>
<p><strong>Key finding</strong>: The Modified HP filter produced lower
mean squared error in recovering the true cycle in nearly 100% of
simulations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Generate true components</span></span>
<span><span class="va">trend_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cycle_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>, <span class="va">n</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">trend_true</span> <span class="op">+</span> <span class="va">cycle_true</span></span>
<span></span>
<span><span class="co"># Apply both filters</span></span>
<span><span class="va">mhp_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">y</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">hp_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hp_filter.html">hp_filter</a></span><span class="op">(</span><span class="va">y</span>, lambda <span class="op">=</span> <span class="fl">1600</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute MSE</span></span>
<span><span class="va">mse_mhp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">mhp_result</span><span class="op">$</span><span class="va">cycle</span> <span class="op">-</span> <span class="va">cycle_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mse_hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">hp_result</span><span class="op">$</span><span class="va">cycle</span> <span class="op">-</span> <span class="va">cycle_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cycle_true</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cycle_true</span>, <span class="va">mhp_result</span><span class="op">$</span><span class="va">cycle</span>, <span class="va">hp_result</span><span class="op">$</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"True vs Estimated Cycles"</span>, ylab <span class="op">=</span> <span class="st">"Cycle"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mhp_result</span><span class="op">$</span><span class="va">cycle</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">hp_result</span><span class="op">$</span><span class="va">cycle</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"True Cycle"</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"MHP (λ="</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">mhp_result</span><span class="op">)</span>, <span class="st">", MSE="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mse_mhp</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"HP (λ=1600, MSE="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mse_hp</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="methodology_files/figure-html/simulation-1.png" class="r-plt" alt="Simulation: True vs Estimated Cycles" width="672"><p class="caption">
Simulation: True vs Estimated Cycles
</p>
</div>
</div>
<div class="section level3">
<h3 id="empirical-evidence">3.2 Empirical Evidence<a class="anchor" aria-label="anchor" href="#empirical-evidence"></a>
</h3>
<p>Choudhary et al. (2014) estimated optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for 93 countries using annual data and 25 countries using quarterly
data. Key findings:</p>
<table class="table">
<thead><tr class="header">
<th>Statistic</th>
<th>Annual Data</th>
<th>Quarterly Data</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Range of λ</td>
<td>11 - 6,566</td>
<td>229 - 4,898</td>
</tr>
<tr class="even">
<td>Fixed λ</td>
<td>100</td>
<td>1,600</td>
</tr>
</tbody>
</table>
<p><strong>Implications</strong>:</p>
<ol style="list-style-type: decimal">
<li>Optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
varies substantially across countries</li>
<li>Few countries have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
close to conventional values</li>
<li>Standard HP tends to underestimate cyclical volatility (positive
<code>sd_diff</code>)</li>
<li>AR(1) coefficients are relatively robust to filter choice</li>
<li>Correlations between series can differ significantly</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate cross-country variation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate countries with different characteristics</span></span>
<span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Stable_Developed"</span>, <span class="st">"Volatile_Emerging"</span>, <span class="st">"Moderate"</span><span class="op">)</span>,</span>
<span>  trend_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  cycle_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  cycle_ar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">countries</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0.5</span>, <span class="va">countries</span><span class="op">$</span><span class="va">trend_sd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">cycle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="va">countries</span><span class="op">$</span><span class="va">cycle_ar</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="fl">80</span>, sd <span class="op">=</span> <span class="va">countries</span><span class="op">$</span><span class="va">cycle_sd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">trend</span> <span class="op">+</span> <span class="va">cycle</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">y</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">countries</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, lambda <span class="op">=</span> <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;              country lambda</span></span>
<span><span class="co">#&gt;               &lt;char&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:  Stable_Developed    714</span></span>
<span><span class="co">#&gt; 2: Volatile_Emerging    604</span></span>
<span><span class="co">#&gt; 3:          Moderate    401</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="theoretical-justification">4. Theoretical Justification<a class="anchor" aria-label="anchor" href="#theoretical-justification"></a>
</h2>
<div class="section level3">
<h3 id="why-cross-validation">4.1 Why Cross-Validation?<a class="anchor" aria-label="anchor" href="#why-cross-validation"></a>
</h3>
<p>Cross-validation is optimal in the sense that it asymptotically
minimizes the <strong>integrated squared error</strong> between the
estimated trend and the true trend (Craven &amp; Wahba, 1979).</p>
<p>The GCV function has several desirable properties:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Rotation invariant</strong>: Does not depend on the
coordinate system</li>
<li>
<strong>Asymptotically optimal</strong>: Converges to the best
possible
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
</li>
<li>
<strong>Computationally efficient</strong>: Closed-form
approximation available</li>
</ol>
</div>
<div class="section level3">
<h3 id="relationship-to-signal-extraction">4.2 Relationship to Signal Extraction<a class="anchor" aria-label="anchor" href="#relationship-to-signal-extraction"></a>
</h3>
<p>The HP filter can be viewed as a Wiener-Kolmogorov filter for signal
extraction. If:</p>
<ul>
<li>Trend follows a random walk:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>2</mn></msup><msub><mi>g</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Delta^2 g_t = \varepsilon_t</annotation></semantics></math>
</li>
<li>Cycle is stationary noise:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>t</mi></msub><annotation encoding="application/x-tex">c_t</annotation></semantics></math>
stationary</li>
</ul>
<p>Then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><msubsup><mi>σ</mi><mi>c</mi><mn>2</mn></msubsup><mi>/</mi><msubsup><mi>σ</mi><mi>ε</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\lambda = \sigma_c^2 / \sigma_\varepsilon^2</annotation></semantics></math>
is the optimal filter.</p>
<p>The GCV approach implicitly estimates this ratio from the data.</p>
</div>
<div class="section level3">
<h3 id="connection-to-spline-smoothing">4.3 Connection to Spline Smoothing<a class="anchor" aria-label="anchor" href="#connection-to-spline-smoothing"></a>
</h3>
<p>The HP filter is equivalent to a cubic smoothing spline. The GCV
method for choosing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is the same used in spline smoothing literature (Silverman, 1984).</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-recommendations">5. Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="when-to-use-modified-hp-filter">5.1 When to Use Modified HP Filter<a class="anchor" aria-label="anchor" href="#when-to-use-modified-hp-filter"></a>
</h3>
<p><strong>Use Modified HP when</strong>:</p>
<ul>
<li>Analyzing series from different countries (cross-country
comparisons)</li>
<li>Working with different macro variables (GDP, consumption,
investment)</li>
<li>Unsure about appropriate λ for your specific context</li>
<li>Need defensible, data-driven parameter selection</li>
</ul>
<p><strong>Standard HP may be acceptable when</strong>:</p>
<ul>
<li>Following established literature conventions exactly</li>
<li>Comparing results with published studies using λ = 1600</li>
<li>Time series closely matches U.S. quarterly GDP characteristics</li>
</ul>
</div>
<div class="section level3">
<h3 id="choosing-max_lambda">5.2 Choosing max_lambda<a class="anchor" aria-label="anchor" href="#choosing-max_lambda"></a>
</h3>
<p>The <code>max_lambda</code> parameter affects computation time and
search range:</p>
<table class="table">
<thead><tr class="header">
<th>max_lambda</th>
<th>Use Case</th>
<th>Speed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>5,000</td>
<td>Quick exploratory analysis</td>
<td>~0.05s</td>
</tr>
<tr class="even">
<td>10,000</td>
<td>Most quarterly macro series</td>
<td>~0.1s</td>
</tr>
<tr class="odd">
<td>50,000</td>
<td>Conservative, unusual series</td>
<td>~0.5s</td>
</tr>
<tr class="even">
<td>100,000</td>
<td>Very smooth trends needed</td>
<td>~1s</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For most macro applications, 10000 is sufficient</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_filter.html">mhp_filter</a></span><span class="op">(</span><span class="va">y</span>, max_lambda <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal lambda:"</span>, <span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal lambda: 1400</span></span>
<span></span>
<span><span class="co"># If optimal λ hits the upper bound, increase max_lambda</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/get_lambda.html">get_lambda</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">9900</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Lambda near upper bound - consider increasing max_lambda"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-results">5.3 Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h3>
<p>Key diagnostics when comparing HP vs Modified HP:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mhp_compare.html">mhp_compare</a></span><span class="op">(</span><span class="va">y</span>, frequency <span class="op">=</span> <span class="st">"quarterly"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span></span>
<span><span class="co">#&gt;         method lambda cycle_sd   cycle_mean       ar1 cycle_range      gcv</span></span>
<span><span class="co">#&gt;         &lt;char&gt;  &lt;num&gt;    &lt;num&gt;        &lt;num&gt;     &lt;num&gt;       &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:          HP   1600 2.444616 1.890115e-12 0.7519842    12.29935       NA</span></span>
<span><span class="co">#&gt; 2: Modified HP   1400 2.424745 1.567173e-12 0.7477953    12.20010 6.652109</span></span>
<span></span>
<span><span class="co"># Interpretation guide:</span></span>
<span><span class="co"># 1. Large lambda difference: series-specific smoothing important</span></span>
<span><span class="co"># 2. Positive sd_diff: HP under-estimates cycle volatility</span></span>
<span><span class="co"># 3. Large ar1_diff: affects model calibration</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="mathematical-appendix">6. Mathematical Appendix<a class="anchor" aria-label="anchor" href="#mathematical-appendix"></a>
</h2>
<div class="section level3">
<h3 id="derivation-of-hp-filter-solution">6.1 Derivation of HP Filter Solution<a class="anchor" aria-label="anchor" href="#derivation-of-hp-filter-solution"></a>
</h3>
<p>The first-order conditions of the minimization problem:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>g</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>g</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>g</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>λ</mi><mi>g</mi><mi>′</mi><mi>A</mi><mi>g</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial g} \left[ (y-g)'(y-g) + \lambda g'A g \right] = 0</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>g</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>2</mn><mi>λ</mi><mi>A</mi><mi>g</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">-2(y-g) + 2\lambda A g = 0</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>+</mo><mi>λ</mi><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>g</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">(I + \lambda A)g = y</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>+</mo><mi>λ</mi><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">g = (I + \lambda A)^{-1} y</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="structure-of-matrix-a">6.2 Structure of Matrix A<a class="anchor" aria-label="anchor" href="#structure-of-matrix-a"></a>
</h3>
<p>The matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>K</mi><mi>′</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">A = K'K</annotation></semantics></math>
is a symmetric, positive semi-definite band matrix:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>4</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>4</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>6</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>4</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>4</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>6</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>4</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A = \begin{pmatrix}
1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 &amp; \cdots \\
-2 &amp; 5 &amp; -4 &amp; 1 &amp; 0 &amp; \cdots \\
1 &amp; -4 &amp; 6 &amp; -4 &amp; 1 &amp; \cdots \\
0 &amp; 1 &amp; -4 &amp; 6 &amp; -4 &amp; \cdots \\
\vdots &amp; &amp; &amp; \ddots &amp; &amp; \\
\end{pmatrix}</annotation></semantics></math></p>
<p>This banded structure allows efficient computation using sparse
matrix methods (not exploited in this implementation, but potential for
future optimization).</p>
</div>
<div class="section level3">
<h3 id="gcv-approximation">6.3 GCV Approximation<a class="anchor" aria-label="anchor" href="#gcv-approximation"></a>
</h3>
<p>Starting from:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">∥</mo><mi>y</mi><mo>−</mo><mover><mi>g</mi><mo accent="true">̂</mo></mover><msup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn></msup></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mtext mathvariant="normal">tr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">GCV(\lambda) = \frac{T^{-1} \|y - \hat{g}\|^2}{(1 - T^{-1}\text{tr}(B))^2}</annotation></semantics></math></p>
<p>Using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>2</mn></mrow></msup><mo>≈</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>x</mi></mrow><annotation encoding="application/x-tex">(1-x)^{-2} \approx 1 + 2x</annotation></semantics></math>
for small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">∥</mo><mi>y</mi><mo>−</mo><mover><mi>g</mi><mo accent="true">̂</mo></mover><msup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mtext mathvariant="normal">tr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">GCV(\lambda) \approx T^{-1} \|y - \hat{g}\|^2 (1 + 2T^{-1}\text{tr}(B))</annotation></semantics></math></p>
<p>With Silverman’s approximation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">tr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mi>T</mi><mi>/</mi><mi>λ</mi></mrow><annotation encoding="application/x-tex">\text{tr}(B) \approx T/\lambda</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><msup><mi>T</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>T</mi><mi>/</mi><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">∥</mo><mi>y</mi><mo>−</mo><mover><mi>g</mi><mo accent="true">̂</mo></mover><msup><mo stretchy="false" form="postfix">∥</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">GCV(\lambda) \approx T^{-1}(1 + 2T/\lambda) \|y - \hat{g}\|^2</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Choudhary, M.A., Hanif, M.N., &amp; Iqbal, J. (2014). On
smoothing macroeconomic time series using the modified HP filter.
<em>Applied Economics</em>, 46(19), 2205-2214.</p></li>
<li><p>Craven, P., &amp; Wahba, G. (1979). Smoothing noisy data with
spline functions. <em>Numerische Mathematik</em>, 31, 377-403.</p></li>
<li><p>Hodrick, R.J., &amp; Prescott, E.C. (1997). Postwar US business
cycles: An empirical investigation. <em>Journal of Money, Credit and
Banking</em>, 29(1), 1-16.</p></li>
<li><p>Marcet, A., &amp; Ravn, M.O. (2004). The HP-filter in
cross-country comparisons. <em>CEPR Discussion Paper</em>
No. 4244.</p></li>
<li><p>McDermott, C.J. (1997). An automatic method for choosing the
smoothing parameter in the HP filter. Unpublished manuscript,
IMF.</p></li>
<li><p>Ravn, M.O., &amp; Uhlig, H. (2002). On adjusting the
Hodrick-Prescott filter for the frequency of observations. <em>Review of
Economics and Statistics</em>, 84(2), 371-376.</p></li>
<li><p>Silverman, B.W. (1984). A fast and efficient cross-validation
method for smoothing parameter choice in spline regression. <em>Journal
of the American Statistical Association</em>, 79, 584-589.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.researchgate.net/profile/Muhammad_Yaseen10" class="external-link">Muhammad Yaseen</a>. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Licensed under <a href="https://opensource.org/licenses/MIT" class="external-link">MIT License</a> Please cite: <a href="https://doi.org/10.1080/00036846.2014.896982" class="external-link">Choudhary, Hanif &amp; Iqbal (2014)</a> “On smoothing macroeconomic time series using the modified HP filter.” Applied Economics, 46(19), 2205-2214.</p>
</div>

    </footer>
</div>





  </body>
</html>
